# Миграция на PyTChat

## Что изменилось?

Из-за изменений в структуре YouTube, старая библиотека `chat-downloader` перестала работать с ошибкой **"Unable to parse initial video data"**.

**Решение:** Переход на библиотеку `pytchat`, которая более стабильна и активно поддерживается.

## Что было сделано?

1. ✅ Установлена библиотека `pytchat`
2. ✅ Создан новый парсер `chat_parser_pytchat.py` на основе pytchat
3. ✅ Обновлен GUI для использования нового парсера
4. ✅ Протестирована работа - парсер успешно получает сообщения

## Формат данных

Формат сохраняемых сообщений **полностью совместим** со старой системой:

```json
{
  "id": "уникальный_id",
  "text": "текст_сообщения",
  "author": {
    "name": "имя_автора",
    "avatar": "url_аватара",
    "is_sponsor": false,
    "is_moderator": false,
    "is_owner": true,
    "badges": []
  },
  "timestamp": 1762088720
}
```

## Как использовать?

### Через GUI (рекомендуется)

1. Запустите `START.bat` в папке `chat_overlay`
2. Вставьте URL трансляции
3. Нажмите "Запустить всё" или "Запустить только парсер"

GUI автоматически использует новый парсер `chat_parser_pytchat.py`

### Через командную строку

```bash
cd chat_overlay
venv\Scripts\python.exe chat_parser_pytchat.py "https://youtube.com/live/VIDEO_ID"
```

## Старый парсер

Старый файл `chat_parser_gui.py` (на основе chat-downloader) **сохранен**, но не рекомендуется к использованию, пока не будет обновлена библиотека chat-downloader.

## Преимущества pytchat

- ✅ Более стабильная работа с YouTube API
- ✅ Активная поддержка и обновления
- ✅ Лучшая обработка различных типов сообщений
- ✅ Поддержка Super Chat, членства и других функций YouTube

## Дата миграции

2 ноября 2025

