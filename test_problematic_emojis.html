<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —ç–º–æ–¥–∂–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .youtube-emoji {
            width: 70px !important;
            height: 70px !important;
            vertical-align: middle !important;
            margin: 0 5px !important;
            display: inline-block !important;
            border: 2px solid #4CAF50;
            border-radius: 4px;
        }
        
        .test-input {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .result {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            min-height: 80px;
            font-size: 18px;
            line-height: 1.5;
        }
        
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö YouTube —ç–º–æ–¥–∂–∏</h1>
    
    <div class="test-section">
        <h2>üéØ –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–æ–¥—ã:</h2>
        <div class="info status">
            <strong>–¢–µ—Å—Ç–∏—Ä—É–µ–º:</strong><br>
            ‚Ä¢ <code>:ops:</code> ‚Üí –¥–æ–ª–∂–Ω–æ —Å—Ç–∞—Ç—å <code>:oops:</code><br>
            ‚Ä¢ <code>:ctopus-red-waving:</code> ‚Üí –¥–æ–ª–∂–Ω–æ —Å—Ç–∞—Ç—å <code>:octopus-red-waving:</code>
        </div>
    </div>
    
    <div class="test-section">
        <h2>üìù –†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</h2>
        <input type="text" class="test-input" id="testInput" 
               placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —ç–º–æ–¥–∂–∏..." 
               value=":ukraine: :usa: :germany: :france: :uk: :poland: :canada: :japan: :china:">
        <button onclick="testEmojis()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">–¢–µ—Å—Ç</button>
        
        <div class="result" id="result">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...</div>
    </div>
    
    <div class="test-section">
        <h2>üìä –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏:</h2>
        <div id="loadStatus" class="info status">–ó–∞–≥—Ä—É–∂–∞–µ–º YouTube —ç–º–æ–¥–∂–∏...</div>
    </div>
    
    <div class="test-section">
        <h2>üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h2>
        <div id="debugInfo" class="info status">
            <div>YouTube —ç–º–æ–¥–∂–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: <span id="emojiCount">0</span></div>
            <div>–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã: <span id="altCodes">–Ω–µ—Ç</span></div>
        </div>
    </div>

    <script>
        // –ë–∞–∑–æ–≤—ã–µ —ç–º–æ–¥–∂–∏
        const EMOJI_MAP = {
            // –ù–æ–≤—ã–µ —ç–º–æ–¥–∂–∏ (–¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º)
            ':grey_heart:': 'ü©∂', ':gray_heart:': 'ü©∂',
            ':light_blue_heart:': 'ü©µ', ':blue_heart:': 'üíô',
            ':melting_face:': 'ü´†', ':face_holding_back_tears:': 'ü•π',
            ':goose:': 'ü™ø', ':brown_mushroom:': 'üçÑ',
            ':pink_heart:': 'ü©∑', ':rainbow_flag:': 'üè≥Ô∏è‚Äçüåà',
            // –§–ª–∞–≥–∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤
            ':ukraine:': 'üá∫üá¶', ':ua:': 'üá∫üá¶', ':flag_ua:': 'üá∫üá¶',
            ':russia:': 'üá∑üá∫', ':ru:': 'üá∑üá∫', ':flag_ru:': 'üá∑üá∫',
            ':usa:': 'üá∫üá∏', ':us:': 'üá∫üá∏', ':flag_us:': 'üá∫üá∏',
            ':germany:': 'üá©üá™', ':de:': 'üá©üá™', ':flag_de:': 'üá©üá™',
            ':france:': 'üá´üá∑', ':fr:': 'üá´üá∑', ':flag_fr:': 'üá´üá∑',
            ':uk:': 'üá¨üáß', ':gb:': 'üá¨üáß', ':flag_gb:': 'üá¨üáß',
            ':poland:': 'üáµüá±', ':pl:': 'üáµüá±', ':flag_pl:': 'üáµüá±',
            ':canada:': 'üá®üá¶', ':ca:': 'üá®üá¶', ':flag_ca:': 'üá®üá¶',
            ':japan:': 'üáØüáµ', ':jp:': 'üáØüáµ', ':flag_jp:': 'üáØüáµ',
            ':china:': 'üá®üá≥', ':cn:': 'üá®üá≥', ':flag_cn:': 'üá®üá≥'
        };
        
        // YouTube —ç–º–æ–¥–∂–∏ (–∑–∞–≥—Ä—É–∂–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
        let YOUTUBE_EMOJIS = {};
        
        // –§–ª–∞–≥–∏ —Å—Ç—Ä–∞–Ω (–∑–∞–≥—Ä—É–∂–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
        let FLAGS_DATA = {};
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ YouTube —ç–º–æ–¥–∂–∏
        async function loadYouTubeEmojis() {
            try {
                console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º YouTube —ç–º–æ–¥–∂–∏...');
                const response = await fetch('youtube_emojis.json?' + Date.now());
                
                if (response.ok) {
                    const text = await response.text();
                    YOUTUBE_EMOJIS = JSON.parse(text);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–¥—ã –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —ç–º–æ–¥–∂–∏
                    addAlternativeEmojiCodes();
                    
                    console.log('‚úÖ YouTube —ç–º–æ–¥–∂–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', Object.keys(YOUTUBE_EMOJIS).length);
                    updateStatus();
                } else {
                    console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ YouTube —ç–º–æ–¥–∂–∏:', response.status, response.statusText);
                    document.getElementById('loadStatus').innerHTML = '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ YouTube —ç–º–æ–¥–∂–∏';
                    document.getElementById('loadStatus').className = 'error status';
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å YouTube —ç–º–æ–¥–∂–∏:', error);
                document.getElementById('loadStatus').innerHTML = '‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å YouTube —ç–º–æ–¥–∂–∏: ' + error.message;
                document.getElementById('loadStatus').className = 'error status';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –∫–æ–¥–æ–≤ —ç–º–æ–¥–∂–∏
        function addAlternativeEmojiCodes() {
            let addedCodes = [];
            
            // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–æ–¥—ã —ç–º–æ–¥–∂–∏
            if (YOUTUBE_EMOJIS[':oops:']) {
                // :ops: -> :oops:
                YOUTUBE_EMOJIS[':ops:'] = YOUTUBE_EMOJIS[':oops:'];
                console.log('üîß –î–æ–±–∞–≤–ª–µ–Ω –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ–¥: :ops: -> :oops:');
                addedCodes.push(':ops: ‚Üí :oops:');
            }
            
            if (YOUTUBE_EMOJIS[':octopus-red-waving:']) {
                // :ctopus-red-waving: -> :octopus-red-waving:
                YOUTUBE_EMOJIS[':ctopus-red-waving:'] = YOUTUBE_EMOJIS[':octopus-red-waving:'];
                console.log('üîß –î–æ–±–∞–≤–ª–µ–Ω –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ–¥: :ctopus-red-waving: -> :octopus-red-waving:');
                addedCodes.push(':ctopus-red-waving: ‚Üí :octopus-red-waving:');
            }
            
            document.getElementById('altCodes').innerHTML = addedCodes.length > 0 ? addedCodes.join('<br>') : '–Ω–µ—Ç';
        }
        
        function convertEmojis(text) {
            let result = text;
            let replacements = 0;
            
            console.log('üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —ç–º–æ–¥–∂–∏ –≤ —Ç–µ–∫—Å—Ç–µ:', text);
            
            // 1. –°–Ω–∞—á–∞–ª–∞ YouTube —ç–º–æ–¥–∂–∏
            for (const [code, emoji] of Object.entries(YOUTUBE_EMOJIS)) {
                const escapedCode = code.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(escapedCode, 'g');
                const matches = (result.match(regex) || []).length;
                if (matches > 0) {
                    console.log(`üì∫ –ó–∞–º–µ–Ω—è–µ–º YouTube —ç–º–æ–¥–∂–∏: ${code} (${matches} —Ä–∞–∑)`);
                    // –£–±–∏—Ä–∞–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏–∑ YouTube —ç–º–æ–¥–∂–∏
                    const cleanEmoji = emoji.replace(/style="[^"]*"/g, '');
                    result = result.replace(regex, cleanEmoji);
                    replacements += matches;
                }
            }
            
            // 2. –ó–∞—Ç–µ–º –±–∞–∑–æ–≤—ã–µ —ç–º–æ–¥–∂–∏
            for (const [code, emoji] of Object.entries(EMOJI_MAP)) {
                const escapedCode = code.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(escapedCode, 'g');
                const matches = (result.match(regex) || []).length;
                if (matches > 0) {
                    console.log(`üòä –ó–∞–º–µ–Ω—è–µ–º –±–∞–∑–æ–≤—ã–µ —ç–º–æ–¥–∂–∏: ${code} (${matches} —Ä–∞–∑)`);
                    result = result.replace(regex, emoji);
                    replacements += matches;
                }
            }
            
            console.log(`‚úÖ –í—Å–µ–≥–æ –∑–∞–º–µ–Ω–µ–Ω–æ —ç–º–æ–¥–∂–∏: ${replacements}`);
            return result;
        }
        
        function testEmojis() {
            const input = document.getElementById('testInput').value;
            const result = convertEmojis(input);
            document.getElementById('result').innerHTML = result;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—Ä–∞–±–æ—Ç–∞–ª–∏ –ª–∏ –∑–∞–º–µ–Ω—ã
            const hasImages = result.includes('<img');
            const status = document.createElement('div');
            status.className = hasImages ? 'success status' : 'error status';
            status.innerHTML = hasImages ? '‚úÖ –≠–º–æ–¥–∂–∏ –Ω–∞–π–¥–µ–Ω—ã –∏ –∑–∞–º–µ–Ω–µ–Ω—ã!' : '‚ùå –≠–º–æ–¥–∂–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
            
            const resultDiv = document.getElementById('result');
            resultDiv.appendChild(status);
        }
        
        function updateStatus() {
            document.getElementById('loadStatus').innerHTML = '‚úÖ YouTube —ç–º–æ–¥–∂–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã';
            document.getElementById('loadStatus').className = 'success status';
            document.getElementById('emojiCount').textContent = Object.keys(YOUTUBE_EMOJIS).length;
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç
            setTimeout(() => {
                testEmojis();
            }, 500);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            loadYouTubeEmojis();
        });
    </script>
</body>
</html>
